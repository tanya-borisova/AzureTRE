diff --git terraform/variables.tf ../guacamole-azure-windowsvm/terraform/variables.tf
index a5038c01..2fdb0f77 100644
--- terraform/variables.tf
+++ ../guacamole-azure-windowsvm/terraform/variables.tf
@@ -4,5 +4,7 @@ variable "parent_service_id" {}
 variable "tre_resource_id" {}
 variable "image" {}
 variable "vm_size" {}
-variable "shared_storage_access" {}
+variable "shared_storage_access" {
+  type = bool
+}
 variable "shared_storage_name" {}
diff --git terraform/windowsvm.tf ../guacamole-azure-windowsvm/terraform/windowsvm.tf
index 3a083a71..5b58cc4a 100644
--- terraform/windowsvm.tf
+++ ../guacamole-azure-windowsvm/terraform/windowsvm.tf
@@ -92,10 +92,10 @@ data "template_file" "vm_config" {
   template = file("${path.module}/vm_config.ps1")
   vars = {
     nexus_proxy_url     = local.nexus_proxy_url
-    SharedStorageAccess = tobool(var.shared_storage_access) ? 1 : 0
+    SharedStorageAccess = var.shared_storage_access ? 1 : 0
     StorageAccountName  = data.azurerm_storage_account.stg.name
     StorageAccountKey   = data.azurerm_storage_account.stg.primary_access_key
-    FileShareName       = data.azurerm_storage_share.shared_storage.name
+    FileShareName       = var.shared_storage_access ? data.azurerm_storage_share.shared_storage[0].name : ""
     CondaConfig         = local.image_ref[var.image].conda_config ? 1 : 0
   }
 }
@@ -106,6 +106,7 @@ data "azurerm_storage_account" "stg" {
 }

 data "azurerm_storage_share" "shared_storage" {
+  count                = var.shared_storage_access ? 1 : 0
   name                 = var.shared_storage_name
   storage_account_name = data.azurerm_storage_account.stg.name
 }
